<script>
function getUserId(){
  const q = new URLSearchParams(location.search).get("userId");
  const ls = localStorage.getItem("userId");
  const id = parseInt(q ?? ls, 10);
  return Number.isFinite(id) ? id : null;
}

function onPaymentSuccess(){
  const userId = getUserId();
  if(!userId){ alert("ユーザーIDが取得できませんでした"); return; }

  // ← これだけ。サーバが 302 で /user.html?userId=... に飛ばします
  window.location.replace(`/user/upgrade-redirect?userId=${userId}`);
}

window.addEventListener("DOMContentLoaded", onPaymentSuccess);
</script>
